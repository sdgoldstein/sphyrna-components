import{G as q,J as x,H as z,O as A,P as m,n as l,Q as k}from"./runtime-CtH2Mday.js";import{v as w}from"./props-D_2D7U9r.js";function J(r,n,e){q(()=>{var s=x(()=>n(r,e==null?void 0:e())||{});if(e&&(s!=null&&s.update)){var o=!1,c={};z(()=>{var i=e();A(i),o&&m(c,i)&&(c=i,s.update(i))}),o=!0}if(s!=null&&s.destroy)return()=>s.destroy()})}const b=[];function B(r,n){return{subscribe:E(r,n).subscribe}}function E(r,n=l){let e=null;const s=new Set;function o(u){if(m(r,u)&&(r=u,e)){const f=!b.length;for(const t of s)t[1](),b.push(t,r);if(f){for(let t=0;t<b.length;t+=2)b[t][0](b[t+1]);b.length=0}}}function c(u){o(u(r))}function i(u,f=l){const t=[u,f];return s.add(t),s.size===1&&(e=n(o,c)||l),u(r),()=>{s.delete(t),s.size===0&&e&&(e(),e=null)}}return{set:o,update:c,subscribe:i}}function O(r,n,e){const s=!Array.isArray(r),o=s?[r]:r;if(!o.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const c=n.length<2;return B(e,(i,u)=>{let f=!1;const t=[];let d=0,p=l;const h=()=>{if(d)return;p();const a=n(s?t[0]:t,i,u);c?i(a):p=typeof a=="function"?a:l},_=o.map((a,y)=>w(a,g=>{t[y]=g,d&=~(1<<y),f&&h()},()=>{d|=1<<y}));return f=!0,h(),function(){k(_),p(),f=!1}})}function P(r){return{subscribe:r.subscribe.bind(r)}}function Q(r){let n;return w(r,e=>n=e)(),n}export{J as a,P as b,O as d,Q as g,B as r,E as w};
